<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="dsfd"><title>基于Docker的Ethereum 开发环境搭建 | 雨天</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">基于Docker的Ethereum 开发环境搭建</h1><a id="logo" href="/.">雨天</a><p class="description">行百里者半九十</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">基于Docker的Ethereum 开发环境搭建</h1><div class="post-meta">Oct 7, 2017<span> | </span><span class="category"><a href="/categories/区块链/">区块链</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span></div><div class="post-content"><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>最近在研究区块链相关的东西，作为一个程序员，当然想自己动手尝试一下。最后决定选择搭建一个Ethereum的开发环境，试着开发一下智能合约。<br>折腾了两天，觉得搭建一个开发环境依赖太多的东西，这样对一个刚入门的新手来说不够友好，所以最后决定使用Docker来搭建开发环境，部署起来也方便，而且不过分依赖本机的环境。<br>本文主要将了使用docker搭建起geth的集群，然后使用remix做为IDE来开发和调试合约。</p>
<h2 id="docker环境准备"><a href="#docker环境准备" class="headerlink" title="docker环境准备"></a>docker环境准备</h2><p>如果没有安装的，可以在docker的<a href="https://docs.docker.com/" target="_blank" rel="external">官网</a>安装下载，现在mac，windows都有桌面版，各个linux的发型版都也都有说明，这里就不细说了。</p>
<p>安装完之后，执行<code>docker -v</code>就可以查看docker的版本号了：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">➜  ~ docker -v</div><div class="line">Docker version 17.09.0-ce, build afdb6d4</div></pre></td></tr></table></figure></p>
<h2 id="go-eth集群搭建"><a href="#go-eth集群搭建" class="headerlink" title="go-eth集群搭建"></a>go-eth集群搭建</h2><p>在github的<a href="https://github.com/yutianwu/ethereum-docker" target="_blank" rel="external">Capgemini-AIE/ethereum-docker</a>这个repo下有搭建geth集群的docker编排文件。细节有兴趣的回过头来可以详细了解一下。</p>
<h3 id="clone代码"><a href="#clone代码" class="headerlink" title="clone代码"></a>clone代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">➜  eth git clone https://github.com/yutianwu/ethereum-docker</div><div class="line">Cloning into &apos;ethereum-docker&apos;...</div><div class="line">remote: Counting objects: 115, done.</div><div class="line">remote: Total 115 (delta 0), reused 0 (delta 0), pack-reused 115</div><div class="line">Receiving objects: 100% (115/115), 20.97 KiB | 0 bytes/s, done.</div><div class="line">Resolving deltas: 100% (44/44), done.</div><div class="line">Checking connectivity... done.</div></pre></td></tr></table></figure>
<h3 id="使用单机模式启动"><a href="#使用单机模式启动" class="headerlink" title="使用单机模式启动"></a>使用单机模式启动</h3><p>用<code>docker-compose</code>使用<code>docker-compose-standalone.yml</code>在单机模式下启动，也就是启动一个docker容器。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">➜  ethereum-docker git:(master) docker-compose -f docker-compose-standalone.yml up -d</div><div class="line">Creating ethereumdocker_geth_1 ...</div><div class="line">Creating ethereumdocker_geth_1 ... done</div><div class="line">➜  ethereum-docker git:(master) docker ps</div><div class="line">CONTAINER ID        IMAGE                COMMAND                  CREATED                  STATUS              PORTS                                                                                  NAMES</div><div class="line">2b87b5a814ce        ethereum/client-go   &quot;geth --datadir=/r...&quot;   Less than a second ago   Up 4 seconds        0.0.0.0:8545-&gt;8545/tcp, 0.0.0.0:30303-&gt;30303/tcp, 8546/tcp, 0.0.0.0:30303-&gt;30303/udp   ethereumdocker_geth_1</div></pre></td></tr></table></figure></p>
<p>使用<code>docker exec</code>进入容器：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">➜  ethereum-docker git:(master) docker exec -it ethereumdocker_geth_1 geth attach ipc://root/.ethereum/devchain/geth.ipc</div><div class="line">Welcome to the Geth JavaScript console!</div><div class="line"></div><div class="line">instance: Geth/v1.7.3-unstable/linux-amd64/go1.9.2</div><div class="line">coinbase: 0x007ccffb7916f37f7aeef05e8096ecfbe55afc2f</div><div class="line">at block: 0 (Thu, 01 Jan 1970 00:00:00 UTC)</div><div class="line"> datadir: /root/.ethereum/devchain</div><div class="line"> modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0</div><div class="line"></div><div class="line">&gt;</div></pre></td></tr></table></figure></p>
<p>到这里ethereum的client已经运行起来啦。</p>
<h3 id="使用集群模式启动"><a href="#使用集群模式启动" class="headerlink" title="使用集群模式启动"></a>使用集群模式启动</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">➜  ethereum-docker git:(master) docker-compose up -d</div><div class="line">Creating netstats ...</div><div class="line">Creating netstats ... done</div><div class="line">Creating bootstrap ...</div><div class="line">Creating bootstrap ... done</div><div class="line">Creating ethereumdocker_eth_1 ...</div><div class="line">Creating ethereumdocker_eth_1 ... done</div><div class="line">➜  ethereum-docker git:(master) docker ps</div><div class="line">CONTAINER ID        IMAGE                      COMMAND                  CREATED                  STATUS              PORTS                                                                                  NAMES</div><div class="line">a345f0f315d1        ethereumdocker_eth         &quot;/root/start.sh --...&quot;   Less than a second ago   Up 7 seconds        8545-8546/tcp, 30303/tcp, 30303/udp                                                    ethereumdocker_eth_1</div><div class="line">c852e32758e1        ethereumdocker_bootstrap   &quot;/root/start.sh --...&quot;   Less than a second ago   Up 8 seconds        0.0.0.0:8545-&gt;8545/tcp, 0.0.0.0:30303-&gt;30303/tcp, 8546/tcp, 0.0.0.0:30303-&gt;30303/udp   bootstrap</div><div class="line">aa4712bd960b        ethereumdocker_netstats    &quot;npm start&quot;              Less than a second ago   Up 9 seconds        0.0.0.0:3000-&gt;3000/tcp                                                                 netstats</div></pre></td></tr></table></figure>
<p>由于之前我已经下载过镜像了，所以容器就直接启动了，如果首次启动容器的话，会先拉取基础镜像，然后构建好环境才能启动，需要等一会。不过最后你会看到启动了3个容器，分别是两个go-eth的容器和netstats的容器。<br>容器启动之后，我们可以打开<code>http://localhost:3000</code>来查看各个go-eth的状态。<br><img src="/img/ehereum_1.png" alt=""><br>这个时候只是还没有挖矿的节点，也就不会生成区块，虽然创世区块已经准备好啦，但是还是需要手动进入容器启动节点开始挖矿。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">➜  ethereum-docker git:(master) docker exec -it ethereumdocker_eth_1 /bin/bash</div><div class="line">bash-4.3# geth attach ipc://root/.ethereum/devchain/geth.ipc</div><div class="line">Welcome to the Geth JavaScript console!</div><div class="line"></div><div class="line">instance: Geth/v1.7.3-unstable/linux-amd64/go1.9.2</div><div class="line">coinbase: 0x007ccffb7916f37f7aeef05e8096ecfbe55afc2f</div><div class="line">at block: 0 (Thu, 01 Jan 1970 00:00:00 UTC)</div><div class="line"> datadir: /root/.ethereum/devchain</div><div class="line"> modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0</div><div class="line"></div><div class="line">&gt; miner.start()</div><div class="line">null</div></pre></td></tr></table></figure>
<p>再打开netstats的监控界面，稍等一会，就可以看到矿工节点已经开始挖矿并不断生成新的区块啦。<br><img src="/img/ehereum_2.png" alt=""></p>
<p>到这里，ethereum私链的集群已经搭建完毕，接下来就可以基于搭建的集群，搭建开发环境，部署我们的第一个合约啦。</p>
<h3 id="搭建基于remix的开发环境"><a href="#搭建基于remix的开发环境" class="headerlink" title="搭建基于remix的开发环境"></a>搭建基于remix的开发环境</h3><p><a href="http://remix.ethereum.org/" target="_blank" rel="external">remix</a>是官方提供的IDE，可以在线调试，我们前期可以基于在线的Remix开始开发，熟悉之后，可以自己搭建remix或使用其他的开发工具。</p>
<p><img src="/img/ehereum_3.png" alt=""><br>打开remix，默认的http协议为https,此时，<strong>务必手动改为http</strong>,因为使用https时连接不上geth。在Enviroment中选择<code>Web3 Provider</code>，最后就能够连上刚搭建的geth的集群了。</p>
<p><img src="/img/ehereum_4.png" alt=""><br>连上集群之后，我们可以使用启动集群的时候创世区块的几个账号，里面各有一些ether。我们可以使用以下接口查看都有哪些账号：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&gt; web3.eth.accounts</div><div class="line">[</div><div class="line">  &quot;0x007ccffb7916f37f7aeef05e8096ecfbe55afc2f&quot;,</div><div class="line">  &quot;0x99429f64cf4d5837620dcc293c1a537d58729b68&quot;,</div><div class="line">  &quot;0xca247d7425a29c6645fa991f9151f994a830882d&quot;,</div><div class="line">  &quot;0x794f74c8916310d6a0009bb8a43a5acab59a58ad&quot;,</div><div class="line">  &quot;0x276ecb88715a503b00d1f15af4c17dc051991667&quot;,</div><div class="line">  &quot;0x83042c0147acce98e35ed9ef52e6dfc5c67ef92e&quot;,</div><div class="line">  &quot;0x8ab7114ba0f7ca706af69f799588766c8426aa24&quot;,</div><div class="line">  &quot;0x932d9e95e5d2cac02eebbe6763ab2c7b0a9d6a2f&quot;,</div><div class="line">  &quot;0x893c3f80d2a0375b3f00f856cf8a6775e4efc26a&quot;,</div><div class="line">  &quot;0xb1d3073bcc45462a3b0dfe69902cdd12971efec9&quot;</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p>然后解锁第一个账号，这样就可以使用该账号来部署合约了：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; web3.personal.unlockAccount(&quot;0x007ccffb7916f37f7aeef05e8096ecfbe55afc2f&quot;, &quot;&quot;)</div><div class="line">true</div></pre></td></tr></table></figure></p>
<p><img src="/img/ehereum_5.png" alt=""><br>接下来，我们将第一个账户，也就是<code>0x007ccffb7916f37f7aeef05e8096ecfbe55afc2f</code>填入<code>At Address</code>中，点击<code>Create</code>，稍等一会，我们就会看到合约的交易已经在下一个生成的区块,也就是<code>404</code>区块中了。</p>
<p><img src="/img/ehereum_6.png" alt=""><br>部署好合约之后，在下面就会出现合约的接口，我们在<code>set</code>接口的参数中随便填一个数字，稍等一会，我们就会发现这次交易被包含到了<code>425</code>区块中了，查看详细信息，我们可以看到<code>storeData</code>已经变成了我们设置的值。</p>
<p>到此，我们的开发环境就算搭建好了。Have fun！</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://yoursite.com/2017/10/07/2017-10-07-docker-ethereum/" data-id="cj9ozpx460087mqacvdptmv66" class="article-share-link">分享</a><div class="tags"></div><div class="post-nav"><a href="/2017/06/27/2017-06-26-go-profile/" class="next">go 基准测试和pprof的使用</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode/">LeetCode</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/NSQ/">NSQ</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/algorithms/">algorithms</a><span class="category-list-count">32</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/cpp/">cpp</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/">database</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/go/">go</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/golang/">golang</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/lintcode/">lintcode</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/problems/">problems</a><span class="category-list-count">22</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/其他/">其他</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/区块链/">区块链</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/操作系统/">操作系统</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Linked-List/" style="font-size: 15px;">Linked List</a> <a href="/tags/动态规划/" style="font-size: 15px;">动态规划</a> <a href="/tags/图/" style="font-size: 15px;">图</a> <a href="/tags/二分搜索/" style="font-size: 15px;">二分搜索</a> <a href="/tags/Tree/" style="font-size: 15px;">Tree</a> <a href="/tags/Math/" style="font-size: 15px;">Math</a> <a href="/tags/Stack/" style="font-size: 15px;">Stack</a> <a href="/tags/二叉树/" style="font-size: 15px;">二叉树</a> <a href="/tags/Hash-Table/" style="font-size: 15px;">Hash Table</a> <a href="/tags/Array/" style="font-size: 15px;">Array</a> <a href="/tags/Bit-Manipulation/" style="font-size: 15px;">Bit Manipulation</a> <a href="/tags/Deque/" style="font-size: 15px;">Deque</a> <a href="/tags/Two-Pointers/" style="font-size: 15px;">Two Pointers</a> <a href="/tags/设计模式/" style="font-size: 15px;">设计模式</a> <a href="/tags/SkipList/" style="font-size: 15px;">SkipList</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/10/07/2017-10-07-docker-ethereum/">基于Docker的Ethereum 开发环境搭建</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/27/2017-06-26-go-profile/">go 基准测试和pprof的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/26/2017-06-26-go-malloc/">go内存分配</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/19/2017-06-19-ratelimiter/">Ratelimter</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/03/2017-06-03-vm/">虚拟存储器</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/06/2017-05-06-linux-awk/">awk</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/06/2017-05-06-mysql/">mysql的一些细节</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/01/2017-05-01-nsq/">NSQD源码分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/25/2016-03-25-skip-list/">SkipList(跳表)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/22/2016-03-22-stack-problems/">栈的一些巧妙应用</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://1mhz.me" title="1mhz" target="_blank">1mhz</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">雨天.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>